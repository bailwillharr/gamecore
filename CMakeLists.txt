cmake_minimum_required(VERSION 3.25)

project(gamecore_repo)

set(CMAKE_CONFIGURATION_TYPES "Debug;Release;RelWithDebInfo")

# spdlog
set(SPDLOG_BUILD_SHARED OFF CACHE INTERNAL "" FORCE)
set(SPDLOG_SYSTEM_INCLUDES ON CACHE INTERNAL "" FORCE)
set(SPDLOG_USE_STD_FORMAT ON CACHE INTERNAL "" FORCE) # uses builtin fmt and C++20
set(SPDLOG_NO_ATOMIC_LEVELS ON CACHE INTERNAL "" FORCE) # log levels aren't modified concurrently
add_subdirectory(vendor/spdlog EXCLUDE_FROM_ALL)

# SDL3
set(SDL_SHARED ON CACHE INTERNAL "" FORCE)
set(SDL_STATIC OFF CACHE INTERNAL "" FORCE)

set(SDL_TESTS OFF CACHE INTERNAL "" FORCE)
set(SDL_TEST_LIBRARY OFF CACHE INTERNAL "" FORCE)
set(SDL_INSTALL_TESTS OFF CACHE INTERNAL "" FORCE)
set(SDL_EXAMPLES OFF CACHE INTERNAL "" FORCE)
set(SDL_DISABLE_INSTALL ON CACHE INTERNAL "" FORCE)
set(SDL_DISABLE_UNINSTALL ON CACHE INTERNAL "" FORCE)
set(SDL_DISABLE_INSTALL_DOCS ON CACHE INTERNAL "" FORCE)
set(SDL_LIBC ON CACHE INTERNAL "" FORCE)

set(SDL_VULKAN ON CACHE INTERNAL "" FORCE)
# don't need windowing support for these APIs
set(SDL_OPENGL OFF CACHE INTERNAL "" FORCE)
set(SDL_OPENGLES OFF CACHE INTERNAL "" FORCE)
set(SDL_DIRECTX OFF CACHE INTERNAL "" FORCE)

# turn off some subsystems
set(SDL_AUDIO OFF CACHE INTERNAL "" FORCE)
set(SDL_GPU OFF CACHE INTERNAL "" FORCE)
set(SDL_RENDER OFF CACHE INTERNAL "" FORCE)
set(SDL_CAMERA OFF CACHE INTERNAL "" FORCE)
set(SDL_JOYSTICK OFF CACHE INTERNAL "" FORCE)
set(SDL_HAPTIC OFF CACHE INTERNAL "" FORCE)
set(SDL_HIDAPI OFF CACHE INTERNAL "" FORCE)
set(SDL_POWER OFF CACHE INTERNAL "" FORCE)
set(SDL_SENSOR OFF CACHE INTERNAL "" FORCE)

add_subdirectory(vendor/SDL EXCLUDE_FROM_ALL)

# Vulkan SDK
find_package(Vulkan REQUIRED COMPONENTS volk)
if (NOT Vulkan_FOUND)
	message(FATAL_ERROR "Vulkan not found")
endif()
if (NOT Vulkan_volk_FOUND)
	message(FATAL_ERROR "Volk not found")
endif()

# options:
# GC_DEV_BUILD (ON/OFF) - enable trace/debug logging, asserts, etc.
add_subdirectory(gamecore)

add_subdirectory(gamecore_template)

add_subdirectory(tools/gcpak_editor)
